<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{base :: layout(~{::section}, 'Settings')}">

<head>
</head>

<body>

    <section>
        <h1>Settings</h1>

        <div class="settings-grid">

            <div class="settings-card">
                <div class="card-header">
                    <h3>Profile Details</h3>
                    <p>Update your photo and personal details here.</p>
                </div>

                <form th:action="@{/update-profile}" method="post">

                    <div class="profile-section">
                        <img th:if="${user.profileImage != null and !#strings.isEmpty(user.profileImage)}"
                            th:src="@{'/images/' + ${user.profileImage}}" class="big-avatar" style="object-fit: cover;"
                            alt="Profile Photo">

                        <div th:unless="${user.profileImage != null and !#strings.isEmpty(user.profileImage)}"
                            class="big-avatar"
                            style="display: flex; align-items: center; justify-content: center; font-size: 2.5rem; color: white; font-weight: 700;">
                            <span th:text="${#strings.substring(user.firstName,0,1).toUpperCase()}">A</span>
                        </div>

                        <div>
                            <button type="button" class="upload-btn">Change Photo</button>
                            <p style="font-size: 0.8rem; color: #94a3b8; margin-top: 5px;">JPG or PNG, max 2MB</p>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>First Name</label>
                            <input type="text" name="firstName" class="form-input"
                                th:value="${user != null ? user.firstName : 'Alex'}">
                        </div>
                        <div class="form-group">
                            <label>Last Name</label>
                            <input type="text" name="lastName" class="form-input"
                                th:value="${user != null ? user.lastName : 'Dev'}">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Email Address</label>
                        <input type="email" name="email" class="form-input"
                            th:value="${user != null ? user.email : 'alex@example.com'}" readonly>
                    </div>

                    <button type="submit" class="btn-save">Save Changes</button>
                </form>
            </div>

            <div class="settings-card">
                <div class="card-header">
                    <h3>Preferences</h3>
                    <p>Manage your notifications and app appearance.</p>
                </div>

                <div class="toggle-row">
                    <span>Email Notifications</span>
                    <label class="switch">
                        <input type="checkbox" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="toggle-row">
                    <span>Public Profile</span>
                    <label class="switch">
                        <input type="checkbox" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="toggle-row">
                    <span>Sound Effects</span>
                    <label class="switch">
                        <input type="checkbox">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>

            <div class="settings-card" style="border-color: rgba(239, 68, 68, 0.3);">
                <div class="card-header" style="border-color: rgba(239, 68, 68, 0.1);">
                    <h3 style="color: #ef4444;">Danger Zone</h3>
                    <p>Once you delete your account, there is no going back.</p>
                </div>
                <button class="btn-danger" onclick="confirmDelete()">Delete Account</button>
            </div>

        </div>

        <script>
            function confirmDelete() {
                if (confirm("Are you sure you want to delete your account? This cannot be undone.")) {
                    // Call delete API
                    window.location.href = "/delete-account";
                }
            }
        </script>

    </section>

</body>

</html>