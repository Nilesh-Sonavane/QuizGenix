<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{base :: layout(~{::section}, 'Leaderboard')}">

<head>
</head>

<body>
    <section>
        <style>
            /* --- LEADERBOARD HEADER --- */
            h1 {
                font-size: 2.5rem;
                margin-bottom: 0.5rem;
                animation: slideDown 0.6s ease-out;
            }

            .welcome-text {
                color: #94a3b8;
                margin-bottom: 3rem;
                animation: slideDown 0.8s ease-out;
            }

            /* --- PODIUM (TOP 3) --- */
            .podium-container {
                display: flex;
                justify-content: center;
                align-items: flex-end;
                gap: 1.5rem;
                margin-bottom: 4rem;
                padding-top: 2rem;
            }

            .podium-card {
                background: rgba(255, 255, 255, 0.03);
                border: 1px solid rgba(255, 255, 255, 0.1);
                border-radius: 16px;
                padding: 1.5rem;
                text-align: center;
                width: 140px;
                position: relative;
                backdrop-filter: blur(10px);
                transition: transform 0.3s;
            }

            .podium-card:hover {
                transform: translateY(-10px);
                background: rgba(255, 255, 255, 0.08);
            }

            /* Heights for Podium Steps */
            .podium-1 {
                height: 240px;
                border-color: #fbbf24;
                box-shadow: 0 0 30px rgba(251, 191, 36, 0.15);
                z-index: 2;
                order: 2;
                animation: popUp 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) 0.2s backwards;
            }

            .podium-2 {
                height: 200px;
                border-color: #94a3b8;
                order: 1;
                animation: popUp 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) 0.4s backwards;
            }

            .podium-3 {
                height: 180px;
                border-color: #b45309;
                order: 3;
                animation: popUp 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) 0.6s backwards;
            }

            .podium-avatar {
                width: 60px;
                height: 60px;
                border-radius: 50%;
                margin: 0 auto 10px auto;
                background-size: cover;
                background-position: center;
                border: 2px solid rgba(255, 255, 255, 0.2);
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 1.5rem;
                font-weight: bold;
                color: rgba(0, 0, 0, 0.5);
            }

            .crown {
                position: absolute;
                top: -25px;
                left: 50%;
                transform: translateX(-50%);
                font-size: 2rem;
                animation: float 3s ease-in-out infinite;
            }

            .p-rank {
                font-size: 1.5rem;
                font-weight: 800;
                margin-bottom: 5px;
                color: #fff;
            }

            .p-name {
                font-size: 0.9rem;
                font-weight: 600;
                color: #e2e8f0;
                margin-bottom: 5px;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
            }

            .p-xp {
                font-size: 0.8rem;
                color: #94a3b8;
                font-weight: 500;
            }

            /* --- LEADERBOARD LIST --- */
            .leaderboard-list {
                background: rgba(255, 255, 255, 0.02);
                border-radius: 20px;
                border: 1px solid rgba(255, 255, 255, 0.05);
                overflow: hidden;
                margin-bottom: 80px;
                animation: slideUp 1s ease-out 0.5s backwards;
            }

            .list-header {
                display: grid;
                grid-template-columns: 60px 2fr 1fr;
                padding: 1rem 1.5rem;
                background: rgba(255, 255, 255, 0.03);
                border-bottom: 1px solid rgba(255, 255, 255, 0.05);
                color: #94a3b8;
                font-size: 0.85rem;
                font-weight: 600;
                letter-spacing: 1px;
            }

            .list-item {
                display: grid;
                grid-template-columns: 60px 2fr 1fr;
                padding: 1.2rem 1.5rem;
                align-items: center;
                border-bottom: 1px solid rgba(255, 255, 255, 0.05);
                transition: background 0.2s;
            }

            .list-item:hover {
                background: rgba(255, 255, 255, 0.05);
            }

            .l-rank {
                color: #64748b;
                font-weight: 700;
            }

            .l-user {
                display: flex;
                align-items: center;
                gap: 12px;
                color: #f1f5f9;
                font-weight: 600;
            }

            .l-avatar-sm {
                width: 32px;
                height: 32px;
                border-radius: 50%;
                background: linear-gradient(135deg, #6366f1, #a855f7);
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 0.75rem;
                color: white;
            }

            .l-xp {
                color: #fbbf24;
                font-weight: 700;
            }

            /* --- STICKY FOOTER (Current User) --- */
            .sticky-rank {
                position: fixed;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                width: 90%;
                max-width: 800px;
                background: #1e293b;
                border: 1px solid #38bdf8;
                border-radius: 50px;
                padding: 1rem 2rem;
                display: grid;
                grid-template-columns: 60px 2fr 1fr;
                align-items: center;
                box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.5);
                z-index: 100;
                animation: slideUp 1s ease-out 1s backwards;
            }

            .sticky-rank .l-user {
                color: #38bdf8;
            }

            @keyframes popUp {
                0% {
                    transform: scale(0);
                    opacity: 0;
                }

                100% {
                    transform: scale(1);
                    opacity: 1;
                }
            }

            @keyframes slideDown {
                from {
                    transform: translateY(-20px);
                    opacity: 0;
                }

                to {
                    transform: translateY(0);
                    opacity: 1;
                }
            }

            @keyframes slideUp {
                from {
                    transform: translateY(20px);
                    opacity: 0;
                }

                to {
                    transform: translateY(0);
                    opacity: 1;
                }
            }

            @keyframes float {

                0%,
                100% {
                    transform: translate(-50%, 0);
                }

                50% {
                    transform: translate(-50%, -10px);
                }
            }

            @media(max-width: 600px) {
                .podium-container {
                    gap: 0.5rem;
                    align-items: flex-end;
                }

                .podium-card {
                    width: 32%;
                    padding: 1rem 0.5rem;
                }

                .podium-avatar {
                    width: 40px;
                    height: 40px;
                }

                .list-header,
                .list-item,
                .sticky-rank {
                    grid-template-columns: 40px 1fr auto;
                    padding: 1rem;
                }
            }
        </style>

        <h1>Leaderboard</h1>
        <p class="welcome-text">See where you stand among the best developers!</p>

        <div class="podium-container">

            <div class="podium-card podium-2" th:if="${leaderboard.size() > 1}">
                <div class="podium-avatar" style="background-color: #94a3b8; color: #fff;">2</div>
                <div class="p-rank">2</div>
                <div class="p-name"
                    th:text="${#strings.capitalizeWords((leaderboard[1].firstName + ' ' + (leaderboard[1].lastName ?: '')).toLowerCase())}">
                    Player 2
                </div>
                <div class="p-xp" th:text="${#numbers.formatInteger(leaderboard[1].totalXp, 1, 'COMMA') + ' XP'}">0 XP
                </div>
            </div>

            <div class="podium-card podium-1" th:if="${leaderboard.size() > 0}">
                <div class="crown">ðŸ‘‘</div>
                <div class="podium-avatar" style="background-color: #fbbf24; color: #000;">1</div>
                <div class="p-rank">1</div>
                <div class="p-name"
                    th:text="${#strings.capitalizeWords((leaderboard[0].firstName + ' ' + (leaderboard[0].lastName ?: '')).toLowerCase())}">
                    Player 1
                </div>
                <div class="p-xp" th:text="${#numbers.formatInteger(leaderboard[0].totalXp, 1, 'COMMA') + ' XP'}">0 XP
                </div>
            </div>

            <div class="podium-card podium-3" th:if="${leaderboard.size() > 2}">
                <div class="podium-avatar" style="background-color: #b45309; color: #fff;">3</div>
                <div class="p-rank">3</div>
                <div class="p-name"
                    th:text="${#strings.capitalizeWords((leaderboard[2].firstName + ' ' + (leaderboard[2].lastName ?: '')).toLowerCase())}">
                    Player 3
                </div>
                <div class="p-xp" th:text="${#numbers.formatInteger(leaderboard[2].totalXp, 1, 'COMMA') + ' XP'}">0 XP
                </div>
            </div>
        </div>

        <div class="leaderboard-list">
            <div class="list-header">
                <span>#</span>
                <span>PLAYER</span>
                <span>XP</span>
            </div>

            <div class="list-item" th:each="player, stat : ${leaderboard}" th:if="${stat.index > 2}">
                <span class="l-rank" th:text="${stat.count}">4</span>

                <div class="l-user">
                    <div class="l-avatar-sm" th:text="${#strings.substring(player.firstName,0,1)}">A</div>
                    <span
                        th:text="${#strings.capitalizeWords((player.firstName + ' ' + (player.lastName ?: '')).toLowerCase())}">
                        User Name
                    </span>
                </div>

                <span class="l-xp" th:text="${#numbers.formatInteger(player.totalXp, 1, 'COMMA') + ' XP'}">XP</span>
            </div>

            <div th:if="${leaderboard.size() <= 3}" style="text-align: center; padding: 2rem; color: #64748b;">
                No more players to display yet.
            </div>
        </div>

        <div class="sticky-rank">
            <span class="l-rank" style="color: white;" th:text="${myRank}">#</span>
            <div class="l-user">
                <div class="l-avatar-sm" style="background: #38bdf8; color: #000;">Me</div>
                <span>You (<span
                        th:text="${#strings.capitalizeWords((currentUser.firstName + ' ' + (currentUser.lastName ?: '')).toLowerCase())}">Name</span>)</span>
            </div>
            <span class="l-xp" th:text="${#numbers.formatInteger(currentUser.totalXp, 1, 'COMMA') + ' XP'}">0 XP</span>
        </div>

    </section>
</body>

</html>